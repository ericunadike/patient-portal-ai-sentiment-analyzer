<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Patient services portal for Magodo Specialist Hospital.">
    <meta name="keywords" content="hospital, patient services, feedback, registration">
    <meta name="author" content="Magodo Specialist Hospital">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SN9W0VL22Y"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-SN9W0VL22Y');
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script>
        (function() {
            emailjs.init("Z0VMFmiXu1u4xRa9b");
        })();
    </script>
    <title>Patient Services - Magodo Specialist Hospital</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f6f5;
            min-height: 100vh;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
        }
        .main-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 32px;
            padding: 16px;
            max-width: 420px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border: 3px solid rgba(255, 255, 255, 0.2);
            animation: bounceIn 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes bounceIn {
            0% { opacity: 0; transform: translateY(60px) scale(0.3); }
            50% { opacity: 0.8; transform: translateY(-20px) scale(1.05); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }
        .hospital-header {
            text-align: center;
            margin-bottom: 20px;
        }
        .hospital-icon {
            width: 70px;
            height: 70px;
            background: transparent url('MSH LOGO.png') no-repeat center center;
            background-size: contain;
            border-radius: 50%;
            margin: 0 auto 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .hospital-header h1 {
            color: #000080;
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 6px;
        }
        .hospital-header p {
            color: #57CAC3;
            font-size: 14px;
            font-weight: 600;
        }
        .tab-navigation {
            display: flex;
            margin-bottom: 20px;
            border-radius: 20px;
            background: rgba(152, 251, 152, 0.1);
            padding: 6px;
            position: relative;
        }
        .tab-indicator {
            position: absolute;
            background: #27ae60;
            border-radius: 16px;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            width: calc(50% - 12px);
            height: calc(100% - 12px);
            left: 6px;
            top: 6px;
        }
        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            padding: 16px 20px;
            font-size: 14px;
            font-weight: 700;
            color: #636e72;
            cursor: pointer;
            border-radius: 16px;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-transform: uppercase;
        }
        .tab-btn.active {
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        .tab-btn:hover:not(.active) {
            color: #27ae60;
            transform: translateY(-2px);
        }
        .tab-icon {
            font-size: 18px;
        }
        .tab-content {
            display: none;
            animation: slideInUp 0.8s ease;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .form-group {
            margin-bottom: 16px;
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2d3436;
            font-weight: 700;
            font-size: 15px;
        }
        .required::after {
            content: '*';
            color: #e17055;
            margin-left: 4px;
        }
        .form-input {
            width: 100%;
            padding: 16px 18px;
            border: 3px solid #e9ecef;
            border-radius: 16px;
            font-family: inherit;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }
        .form-input:focus {
            outline: none;
            border-color: #27ae60;
            background: white;
        }
        .form-input::placeholder {
            color: #a0a0a0;
            font-size: 14px;
        }
        .form-input.error {
            border-color: #e17055;
            animation: shake 0.6s ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        .error-message {
            color: #e17055;
            font-size: 13px;
            margin-top: 6px;
            display: none;
        }
        .form-input.error + .error-message {
            display: block;
        }
        .form-select {
            width: 100%;
            padding: 16px 36px 16px 18px;
            border: 3px solid #e9ecef;
            border-radius: 16px;
            font-family: inherit;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.9) url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="%23636e72"><path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/></svg>') no-repeat right 12px center;
            background-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
        }
        .form-select:focus {
            outline: none;
            border-color: #27ae60;
            background-color: white;
        }
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            margin-top: 16px;
            padding: 16px;
            border-radius: 16px;
            border: 2px solid transparent;
        }
        .checkbox-group:hover {
            background: rgba(152, 251, 152, 0.08);
            border-color: rgba(152, 251, 152, 0.2);
        }
        .custom-checkbox {
            width: 28px;
            height: 28px;
            border: 3px solid #e9ecef;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.4s ease;
        }
        .custom-checkbox.checked {
            background: #27ae60;
            border-color: #27ae60;
        }
        .custom-checkbox.checked::after {
            content: '✓';
            color: white;
            font-size: 16px;
        }
        .checkbox-label {
            color: #636e72;
            font-size: 15px;
            cursor: pointer;
            line-height: 1.5;
        }
        .payment-info {
            background: rgba(152, 251, 152, 0.1);
            border: 3px solid rgba(152, 251, 152, 0.2);
            border-radius: 20px;
            padding: 20px;
            margin-top: 16px;
            display: none;
        }
        .payment-info.show {
            display: block;
        }
        .payment-info h4 {
            color: #27ae60;
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 12px;
        }
        .payment-info p {
            color: #636e72;
            font-size: 15px;
        }
        .price-highlight {
            color: #27ae60;
            font-weight: 800;
            background: rgba(152, 251, 152, 0.15);
            padding: 4px 8px;
            border-radius: 8px;
        }
        .question-section {
            margin-bottom: 20px;
            padding: 16px;
            background: rgba(152, 251, 152, 0.03);
            border-radius: 20px;
        }
        .question-title {
            color: #2d3436;
            margin-bottom: 16px;
            font-size: 17px;
            font-weight: 800;
            text-align: center;
        }
        .rating-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            margin-bottom: 12px;
        }
        .rating-option {
            border: 3px solid #e9ecef;
            border-radius: 16px;
            background: white;
            cursor: pointer;
            transition: all 0.4s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 4px;
            min-height: 70px;
        }
        .rating-option:hover {
            transform: translateY(-3px);
            border-color: #27ae60;
        }
        .rating-option.selected {
            border-color: #27ae60;
            border-width: 4px;
            transform: translateY(-2px);
        }
        .rating-emoji {
            font-size: 22px;
            margin-bottom: 4px;
        }
        .rating-label {
            font-size: 11px;
            color: #636e72;
            font-weight: 700;
            text-align: center;
            text-transform: uppercase;
        }
        .rating-option.selected .rating-label {
            color: #27ae60;
            font-weight: 800;
        }
        .rating-scale {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #a0a0a0;
        }
        .comment-section {
            margin-bottom: 20px;
            position: relative;
        }
        .comment-input,
        .comment-textarea {
            width: 100%;
            padding: 16px 18px;
            border: 3px solid #e9ecef;
            border-radius: 16px;
            font-family: inherit;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        .comment-textarea {
            resize: vertical;
            min-height: 100px;
            margin-bottom: 16px;
        }
        .comment-input:focus,
        .comment-textarea:focus {
            outline: none;
            border-color: #27ae60;
        }
        .comment-input::placeholder,
        .comment-textarea::placeholder {
            color: #a0a0a0;
            font-size: 14px;
        }
        .voice-button {
            position: absolute;
            bottom: 24px;
            right: 12px;
            width: 40px;
            height: 40px;
            background: #27ae60;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .voice-button:hover {
            transform: scale(1.1);
        }
        .voice-button.active {
            background: #e17055;
        }
        .voice-icon {
            width: 24px;
            height: 24px;
            fill: white;
        }
        .voice-icon .wave {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: none;
        }
        .voice-button.active .wave:nth-child(1) {
            animation: voiceWave1 1.5s infinite;
        }
        .voice-button.active .wave:nth-child(2) {
            animation: voiceWave2 1.5s infinite 0.3s;
        }
        @keyframes voiceWave1 {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.5); opacity: 0.4; }
            100% { transform: scale(2); opacity: 0; }
        }
        @keyframes voiceWave2 {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.3); opacity: 0.4; }
            100% { transform: scale(1.8); opacity: 0; }
        }
        .submit-section {
            text-align: center;
            margin-top: 24px;
        }
        .submit-btn {
            width: 100%;
            padding: 18px 24px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
        }
        .submit-btn:hover:not(:disabled) {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(152, 251, 152, 0.5);
        }
        .submit-btn:disabled {
            background: #ddd;
            cursor: not-allowed;
        }
        .thank-you,
        .registration-success {
            display: none;
            text-align: center;
            padding: 32px 16px;
            animation: celebrationPop 1s ease;
        }
        @keyframes celebrationPop {
            0% { opacity: 0; transform: scale(0.3); }
            50% { opacity: 0.8; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }
        .success-icon,
        .success-animation {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #27ae60;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .success-icon::after,
        .success-animation::after {
            content: '🎉';
            font-size: 32px;
        }
        .thank-you h2,
        .registration-success h2 {
            color: #27ae60;
            margin-bottom: 16px;
            font-size: 24px;
            font-weight: 800;
        }
        .thank-you p,
        .registration-success p {
            color: #636e72;
            font-size: 15px;
            max-width: 320px;
            margin: 0 auto;
        }
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
        }
        @media (max-width: 480px) {
            .main-container {
                padding: 12px;
                max-width: calc(100vw - 4px);
            }
            .hospital-header h1 {
                font-size: 18px;
            }
            .tab-btn {
                padding: 12px 6px;
                font-size: 11px;
            }
            .rating-option {
                min-height: 60px;
            }
            .rating-label {
                font-size: 8px;
            }
            .form-input,
            .form-select,
            .comment-textarea {
                padding: 14px;
                font-size: 16px;
            }
            .submit-btn {
                padding: 16px 20px;
                font-size: 14px;
            }
        }
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none;
                transition-duration: 0.1s;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="hospital-header">
            <div class="hospital-icon" role="img" aria-label="Hospital logo"></div>
            <h1>Magodo Specialist Hospital</h1>
            <p>You are amazing!</p>
        </div>
        <div class="tab-navigation" role="tablist">
            <div class="tab-indicator" id="tabIndicator"></div>
            <button class="tab-btn active" data-tab="feedback" role="tab" aria-selected="true" aria-controls="feedbackTab">
                <span class="tab-icon">💬</span> Feedback
            </button>
            <button class="tab-btn" data-tab="registration" role="tab" aria-selected="false" aria-controls="registrationTab">
                <span class="tab-icon">👤</span> Register
            </button>
        </div>
        <div class="tab-content active" id="feedbackTab" role="tabpanel">
            <div class="survey-form" id="surveyForm">
                <div class="question-section">
                    <h3 class="question-title" id="satisfactionTitle">How satisfied are you with our care?</h3>
                    <div class="rating-grid" id="satisfactionRating" role="radiogroup" aria-labelledby="satisfactionTitle">
                        <button type="button" class="rating-option" data-value="1" role="radio" aria-checked="false">
                            <span class="rating-emoji">😞</span><span class="rating-label">Very Poor</span>
                        </button>
                        <button type="button" class="rating-option" data-value="2" role="radio" aria-checked="false">
                            <span class="rating-emoji">😕</span><span class="rating-label">Poor</span>
                        </button>
                        <button type="button" class="rating-option" data-value="3" role="radio" aria-checked="false">
                            <span class="rating-emoji">😐</span><span class="rating-label">Fair</span>
                        </button>
                        <button type="button" class="rating-option" data-value="4" role="radio" aria-checked="false">
                            <span class="rating-emoji">😊</span><span class="rating-label">Good</span>
                        </button>
                        <button type="button" class="rating-option" data-value="5" role="radio" aria-checked="false">
                            <span class="rating-emoji">🤩</span><span class="rating-label">Excellent</span>
                        </button>
                    </div>
                    <div class="rating-scale">
                        <span>Not satisfied</span><span>Very satisfied</span>
                    </div>
                </div>
                <div class="question-section">
                    <h3 class="question-title" id="recommendTitle">Would you recommend us?</h3>
                    <div class="rating-grid" id="recommendRating" role="radiogroup" aria-labelledby="recommendTitle">
                        <button type="button" class="rating-option" data-value="1" role="radio" aria-checked="false">
                            <span class="rating-emoji">👎</span><span class="rating-label">Never</span>
                        </button>
                        <button type="button" class="rating-option" data-value="2" role="radio" aria-checked="false">
                            <span class="rating-emoji">🤷</span><span class="rating-label">Unlikely</span>
                        </button>
                        <button type="button" class="rating-option" data-value="3" role="radio" aria-checked="false">
                            <span class="rating-emoji">🤔</span><span class="rating-label">Maybe</span>
                        </button>
                        <button type="button" class="rating-option" data-value="4" role="radio" aria-checked="false">
                            <span class="rating-emoji">👍</span><span class="rating-label">Likely</span>
                        </button>
                        <button type="button" class="rating-option" data-value="5" role="radio" aria-checked="false">
                            <span class="rating-emoji">💯</span><span class="rating-label">Definitely</span>
                        </button>
                    </div>
                    <div class="rating-scale">
                        <span>Would not recommend</span><span>Highly recommend</span>
                    </div>
                </div>
                <div class="comment-section">
                    <label for="patientName">Your Name (Optional)</label>
                    <input type="text" id="patientName" class="comment-input" placeholder="What should we call you?">
                </div>
                <div class="comment-section">
                    <label for="patientContact">Email or Phone (Optional)</label>
                    <input type="text" id="patientContact" class="comment-input" placeholder="email@example.com or +234 801 234 5678">
                </div>
                <div class="comment-section">
                    <label for="comments">Share your experience!</label>
                    <textarea id="comments" class="comment-textarea" placeholder="Tell us about your visit..." rows="4"></textarea>
                    <button class="voice-button" id="voiceButton" title="Record your feedback">
                        <svg class="voice-icon" viewBox="0 0 24 24">
                            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1V5zm6.1 6H15V5h2.1c1.66 0 3 1.34 3 3s-1.34 3-3 3zm0 2c2.76 0 5-2.24 5-5s-2.24-5-5-5H6c-2.76 0-5 2.24-5 5s2.24 5 5 5h1.1c1.66 0 3 1.34 3 3v3.5c0 1.38-.62 2.67-1.67 3.54-.31.26-.66.49-1.04.67-.38.18-.79.29-1.22.29s-.84-.11-1.22-.29c-.38-.18-.73-.41-1.04-.67C2.62 18.17 2 16.88 2 15.5V12c0-1.66 1.34-3 3-3h2.1c-1.66 0-3-1.34-3-3s1.34-3 3-3h6c1.66 0 3 1.34 3 3s-1.34 3-3 3z"/>
                            <circle class="wave" cx="12" cy="12" r="0"/>
                            <circle class="wave" cx="12" cy="12" r="0"/>
                        </svg>
                    </button>
                </div>
                <div class="submit-section">
                    <button type="button" class="submit-btn" id="submitBtn" disabled>Send Feedback 🚀</button>
                </div>
            </div>
            <div class="thank-you" id="thankYou">
                <div class="success-icon"></div>
                <h2>Thank You! 🎉</h2>
                <p>Your feedback means the world to us!</p>
            </div>
        </div>
        <div class="tab-content" id="registrationTab" role="tabpanel">
            <form id="registrationForm" novalidate>
                <div class="form-row">
                    <div class="form-group">
                        <label for="lastName" class="required">Last Name</label>
                        <input type="text" id="lastName" class="form-input" placeholder="Your family name" required aria-describedby="lastNameError">
                        <div class="error-message" id="lastNameError">Please enter your last name</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName" class="required">First Name</label>
                        <input type="text" id="firstName" class="form-input" placeholder="Your first name" required aria-describedby="firstNameError">
                        <div class="error-message" id="firstNameError">Please enter your first name</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="middleName">Middle Name</label>
                        <input type="text" id="middleName" class="form-input" placeholder="Your middle name (optional)">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="maritalStatus" class="required">Marital Status</label>
                        <select id="maritalStatus" class="form-select" required aria-describedby="maritalStatusError">
                            <option value="" disabled selected>Select marital status</option>
                            <option value="single">Single</option>
                            <option value="married">Married</option>
                            <option value="divorced">Divorced</option>
                            <option value="widowed">Widowed</option>
                            <option value="separated">Separated</option>
                        </select>
                        <div class="error-message" id="maritalStatusError">Please select your marital status</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="phone" class="required">Phone Number</label>
                        <input type="tel" id="phone" class="form-input" placeholder="e.g. +234 801 234 5678" required aria-describedby="phoneError">
                        <div class="error-message" id="phoneError">Please enter a valid phone number</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" class="form-input" placeholder="e.g. email@example.com" aria-describedby="emailError">
                        <div class="error-message" id="emailError">Please enter a valid email address</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="dateOfBirth" class="required">Date of Birth</label>
                        <input type="date" id="dateOfBirth" class="form-input" required aria-describedby="dateOfBirthError">
                        <div class="error-message" id="dateOfBirthError">Please select your date of birth</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="gender" class="required">Gender</label>
                        <select id="gender" class="form-select" required aria-describedby="genderError">
                            <option value="" disabled selected>Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                        <div class="error-message" id="genderError">Please select your gender</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="payor" class="required">Payor Type</label>
                        <select id="payor" class="form-select" required aria-describedby="payorError">
                            <option value="" disabled selected>Select payor type</option>
                            <option value="personal">Personal - ₦7,500</option>
                            <option value="family">Family - ₦15,000</option>
                            <option value="aiico">AIICO</option>
                            <option value="anchor">Anchor</option>
                            <option value="axamansard">Axamansard</option>
                            <option value="bastion">Bastion</option>
                            <option value="clearline">Clearline</option>
                            <option value="hygeia">Hygeia</option>
                            <option value="leadway">Leadway</option>
                            <option value="nem">NEM</option>
                            <option value="phillips">Phillips</option>
                            <option value="reliance">Reliance</option>
                            <option value="tht">THT</option>
                        </select>
                        <div class="error-message" id="payorError">Please select a payor type</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="hmoId">HMO ID Number</label>
                        <input type="text" id="hmoId" class="form-input" placeholder="Enter your HMO ID" disabled aria-describedby="hmoIdError">
                        <div class="error-message" id="hmoIdError">Please enter your HMO ID</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="address" class="required">Your Address</label>
                    <textarea id="address" class="comment-textarea" placeholder="Enter your full address..." rows="2" required aria-describedby="addressError"></textarea>
                    <div class="error-message" id="addressError">Please enter your address</div>
                </div>
                <div class="payment-info" id="paymentInfo">
                    <h4>💳 Payment Details</h4>
                    <p id="paymentText">Please make payment of <span class="price-highlight">₦7,500</span> to complete your registration.</p>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="consent" class="visually-hidden">
                    <label for="consent" class="custom-checkbox" id="consentCheckbox" role="checkbox" aria-checked="false"></label>
                    <label for="consent" class="checkbox-label">
                        I consent to the processing of my personal information for medical purposes and agree to the hospital's privacy policy.
                    </label>
                </div>
                <div class="submit-section">
                    <button type="submit" class="submit-btn" id="registerBtn" disabled>Complete Registration 🎯</button>
                </div>
            </form>
            <div class="registration-success" id="registrationSuccess">
                <div class="success-animation"></div>
                <h2>Welcome to the Family! 🎉</h2>
                <p id="successMessage">Your registration is complete! We'll be in touch soon! 💚</p>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let currentTab = 'feedback';
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            const tabIndicator = document.getElementById('tabIndicator');
            const registrationForm = document.getElementById('registrationForm');
            const consentCheckbox = document.getElementById('consentCheckbox');
            const consentInput = document.getElementById('consent');
            const registerBtn = document.getElementById('registerBtn');
            const payorSelect = document.getElementById('payor');
            const hmoIdInput = document.getElementById('hmoId');
            const paymentInfo = document.getElementById('paymentInfo');
            const paymentText = document.getElementById('paymentText');
            const submitBtn = document.getElementById('submitBtn');
            const voiceButton = document.getElementById('voiceButton');
            const commentsTextArea = document.getElementById('comments');
            let consentGiven = false;
            let satisfactionRating = null;
            let recommendRating = null;
            let isRecording = false;
            let recognition = null;

            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.lang = 'en-US';
                recognition.interimResults = true;
                recognition.maxAlternatives = 1;
                recognition.onresult = (event) => {
                    const transcript = Array.from(event.results)
                        .map(result => result[0].transcript)
                        .join('');
                    commentsTextArea.value = transcript;
                    updateSubmitButton();
                };
                recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    stopVoiceInput();
                };
                recognition.onend = () => {
                    stopVoiceInput();
                };
            } else {
                voiceButton.style.display = 'none';
            }

            function switchTab(tabName) {
                tabButtons.forEach(btn => {
                    const isActive = btn.dataset.tab === tabName;
                    btn.classList.toggle('active', isActive);
                    btn.setAttribute('aria-selected', isActive);
                });
                tabContents.forEach(content => {
                    content.classList.toggle('active', content.id === `${tabName}Tab`);
                });
                const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
                const containerRect = activeBtn.parentElement.getBoundingClientRect();
                const btnRect = activeBtn.getBoundingClientRect();
                const leftOffset = btnRect.left - containerRect.left - 6;
                tabIndicator.style.transform = `translateX(${leftOffset}px)`;
                currentTab = tabName;
            }

            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => switchTab(btn.dataset.tab));
            });

            function toggleConsent() {
                consentGiven = !consentGiven;
                consentCheckbox.classList.toggle('checked', consentGiven);
                consentCheckbox.setAttribute('aria-checked', consentGiven);
                consentInput.checked = consentGiven;
                validateRegistrationForm();
            }

            consentCheckbox.addEventListener('click', toggleConsent);

            function validateRegistrationForm() {
                const fields = {
                    firstName: document.getElementById('firstName').value.trim(),
                    lastName: document.getElementById('lastName').value.trim(),
                    maritalStatus: document.getElementById('maritalStatus').value,
                    phone: document.getElementById('phone').value.trim(),
                    dateOfBirth: document.getElementById('dateOfBirth').value,
                    gender: document.getElementById('gender').value,
                    address: document.getElementById('address').value.trim(),
                    payor: payorSelect.value,
                    hmoId: hmoIdInput.value.trim()
                };
                const hmoOptions = ['aiico', 'anchor', 'axamansard', 'bastion', 'clearline', 'hygeia', 'leadway', 'nem', 'phillips', 'reliance', 'tht'];
                const hmoIdValid = !hmoOptions.includes(fields.payor) || (hmoOptions.includes(fields.payor) && fields.hmoId);
                const isValid = Object.values(fields).every(field => field || field === fields.hmoId) && consentGiven && hmoIdValid;
                registerBtn.disabled = !isValid;
                ['firstName', 'lastName', 'maritalStatus', 'phone', 'dateOfBirth', 'gender', 'address', 'payor', 'hmoId'].forEach(id => {
                    const element = document.getElementById(id);
                    const errorElement = document.getElementById(`${id}Error`);
                    if (element && errorElement) {
                        element.classList.toggle('error', !element.value.trim() && element.required);
                        errorElement.style.display = !element.value.trim() && element.required ? 'block' : 'none';
                    }
                });
            }

            payorSelect.addEventListener('change', () => {
                const selectedPayor = payorSelect.value;
                const hmoOptions = ['aiico', 'anchor', 'axamansard', 'bastion', 'clearline', 'hygeia', 'leadway', 'nem', 'phillips', 'reliance', 'tht'];
                if (hmoOptions.includes(selectedPayor)) {
                    hmoIdInput.disabled = false;
                    hmoIdInput.required = true;
                    paymentInfo.classList.remove('show');
                } else {
                    hmoIdInput.disabled = true;
                    hmoIdInput.required = false;
                    hmoIdInput.value = '';
                    if (selectedPayor === 'personal') {
                        paymentText.innerHTML = 'Please pay <span class="price-highlight">₦7,500</span> to <span class="price-highlight">5380820030</span> (Moniepoint).';
                        paymentInfo.classList.add('show');
                    } else if (selectedPayor === 'family') {
                        paymentText.innerHTML = 'Please pay <span class="price-highlight">₦15,000</span> to <span class="price-highlight">5380820030</span> (Moniepoint).';
                        paymentInfo.classList.add('show');
                    } else {
                        paymentInfo.classList.remove('show');
                    }
                }
                validateRegistrationForm();
            });

            ['firstName', 'lastName', 'middleName', 'maritalStatus', 'phone', 'dateOfBirth', 'gender', 'address', 'hmoId'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', validateRegistrationForm);
                    element.addEventListener('change', validateRegistrationForm);
                }
            });

            document.getElementById('phone').addEventListener('input', e => {
                let value = e.target.value.replace(/\D/g, '');
                if (value.startsWith('234')) {
                    value = '+' + value;
                } else if (value.startsWith('0')) {
                    value = '+234' + value.substring(1);
                } else if (value && !value.startsWith('+')) {
                    value = '+234' + value;
                }
                e.target.value = value;
                validateRegistrationForm();
            });

            registrationForm.addEventListener('submit', e => {
                e.preventDefault();
                if (registerBtn.disabled) return;
                const selectedPayor = payorSelect.value;
                const registrationData = {
                    lastName: document.getElementById('lastName').value.trim(),
                    firstName: document.getElementById('firstName').value.trim(),
                    middleName: document.getElementById('middleName').value.trim() || 'Not provided',
                    maritalStatus: document.getElementById('maritalStatus').value,
                    phone: document.getElementById('phone').value.trim(),
                    email: document.getElementById('email').value.trim() || 'Not provided',
                    dateOfBirth: document.getElementById('dateOfBirth').value,
                    gender: document.getElementById('gender').value,
                    address: document.getElementById('address').value.trim(),
                    payor: selectedPayor,
                    hmoId: document.getElementById('hmoId').value.trim() || 'Not applicable',
                    timestamp: new Date().toISOString(),
                    registrationId: 'REG-' + Date.now()
                };
                registerBtn.innerHTML = 'Processing...';
                registerBtn.disabled = true;
                sendRegistrationEmail(registrationData);
                updateSuccessMessage(selectedPayor);
                setTimeout(() => {
                    registrationForm.style.display = 'none';
                    document.getElementById('registrationSuccess').style.display = 'block';
                }, 1500);
            });

            function updateSuccessMessage(payorType) {
                const successMessage = document.getElementById('successMessage');
                let message = "Your registration is complete! We'll be in touch soon! 💚";
                if (payorType === 'personal') {
                    message += " Pay ₦7,500 to 5380820030 (Moniepoint).";
                } else if (payorType === 'family') {
                    message += " Pay ₦15,000 to 5380820030 (Moniepoint).";
                }
                successMessage.textContent = message;
            }

            function sendRegistrationEmail(data) {
                const payorDisplay = {
                    'personal': 'Personal (₦7,500)', 'family': 'Family (₦15,000)', 'aiico': 'AIICO', 'anchor': 'Anchor',
                    'axamansard': 'Axamansard', 'bastion': 'Bastion', 'clearline': 'Clearline', 'hygeia': 'Hygeia',
                    'leadway': 'Leadway', 'nem': 'NEM', 'phillips': 'Phillips', 'reliance': 'Reliance', 'tht': 'THT'
                };
                const templateParams = {
                    hospital_name: 'Magodo Specialist Hospital',
                    registration_id: data.registrationId,
                    patient_name: `${data.lastName} ${data.firstName}${data.middleName !== 'Not provided' ? ' ' + data.middleName : ''}`,
                    marital_status: data.maritalStatus,
                    phone_number: data.phone,
                    email_address: data.email,
                    date_of_birth: data.dateOfBirth,
                    gender: data.gender,
                    address: data.address,
                    hmo: payorDisplay[data.payor] || data.payor,
                    hmo_id: data.hmoId,
                    registration_timestamp: new Date(data.timestamp).toLocaleString()
                };
                emailjs.send('service_vmknsar', 'template_2f4o2a9', templateParams)
                    .then(() => console.log('Registration email sent'))
                    .catch(error => console.error('Registration email failed:', error));
            }

            function updateSubmitButton() {
                submitBtn.disabled = !(satisfactionRating !== null && recommendRating !== null);
            }

            document.querySelectorAll('.rating-option').forEach(btn => {
                btn.addEventListener('click', () => {
                    const container = btn.parentElement;
                    container.querySelectorAll('.rating-option').forEach(sibling => {
                        sibling.classList.remove('selected');
                        sibling.setAttribute('aria-checked', 'false');
                    });
                    btn.classList.add('selected');
                    btn.setAttribute('aria-checked', 'true');
                    const value = parseInt(btn.dataset.value);
                    if (container.id === 'satisfactionRating') {
                        satisfactionRating = value;
                    } else if (container.id === 'recommendRating') {
                        recommendRating = value;
                    }
                    updateSubmitButton();
                });
            });

            function startVoiceInput() {
                if (isRecording || !recognition) return;
                isRecording = true;
                voiceButton.classList.add('active');
                recognition.start();
            }

            function stopVoiceInput() {
                if (!isRecording || !recognition) return;
                isRecording = false;
                voiceButton.classList.remove('active');
                recognition.stop();
            }

            voiceButton.addEventListener('click', () => {
                if (isRecording) {
                    stopVoiceInput();
                } else {
                    startVoiceInput();
                }
            });

            submitBtn.addEventListener('click', () => {
                const patientName = document.getElementById('patientName').value.trim();
                const patientContact = document.getElementById('patientContact').value.trim();
                const comments = document.getElementById('comments').value.trim();
                const timestamp = new Date().toISOString();
                const feedbackData = {
                    satisfaction: satisfactionRating,
                    recommendation: recommendRating,
                    patientName: patientName || 'Anonymous',
                    patientContact: patientContact || 'Not provided',
                    comments: comments,
                    timestamp: timestamp,
                    hospital: 'Magodo Specialist Hospital'
                };
                submitFeedback(feedbackData);
            });

            function submitFeedback(data) {
                submitBtn.innerHTML = 'Sending...';
                submitBtn.disabled = true;
                analyzeTextFeedback(data.comments).then(analysis => {
                    data.sentimentAnalysis = analysis;
                    sendFeedbackEmail(data);
                    setTimeout(() => {
                        document.getElementById('surveyForm').style.display = 'none';
                        document.getElementById('thankYou').style.display = 'block';
                    }, 1500);
                });
            }

            function performCustomAnalysis(text) {
                const lowerText = text.toLowerCase();
                const positiveWords = {
                    'excellent': 5, 'great': 4, 'wonderful': 4.5, 'awesome': 4, 'professional': 4.5,
                    'caring': 4.5, 'helpful': 4, 'friendly': 4, 'efficient': 4, 'good': 3.5
                };
                const negativeWords = {
                    'terrible': 1, 'poor': 1.5, 'bad': 1.5, 'disappointing': 2, 'frustrating': 2,
                    'unprofessional': 1.5, 'rude': 1, 'slow': 2, 'uncaring': 1.5
                };
                const topics = {
                    'staff': ['nurse', 'doctor', 'receptionist'],
                    'facility': ['hospital', 'room', 'equipment'],
                    'service': ['treatment', 'care', 'procedure'],
                    'wait time': ['wait', 'delay', 'time']
                };
                let totalScore = 0;
                let wordCount = 0;
                let foundKeywords = [];
                let issues = [];
                let positives = [];
                let detectedTopics = [];
                Object.keys(positiveWords).forEach(word => {
                    if (lowerText.includes(word)) {
                        totalScore += positiveWords[word];
                        wordCount++;
                        foundKeywords.push(word);
                        positives.push(word);
                    }
                });
                Object.keys(negativeWords).forEach(word => {
                    if (lowerText.includes(word)) {
                        totalScore += negativeWords[word];
                        wordCount++;
                        foundKeywords.push(word);
                        if (negativeWords[word] <= 2) issues.push(word);
                    }
                });
                Object.keys(topics).forEach(topic => {
                    if (topics[topic].some(keyword => lowerText.includes(keyword))) {
                        detectedTopics.push(topic);
                    }
                });
                const avgScore = wordCount > 0 ? totalScore / wordCount : 3;
                const sentiment = avgScore >= 3.5 ? 'positive' : avgScore <= 2.5 ? 'negative' : 'neutral';
                const confidence = wordCount > 0 ? Math.min(0.9, wordCount / 10) : 0.5;
                return {
                    score: Math.round(avgScore * 10) / 10,
                    sentiment: sentiment,
                    confidence: confidence,
                    keywords: foundKeywords,
                    issues: issues,
                    positives: positives,
                    topics: detectedTopics
                };
            }

            async function analyzeTextFeedback(text) {
                if (!text || text.trim().length === 0) {
                    return {
                        score: 3,
                        sentiment: 'neutral',
                        confidence: 0.5,
                        keywords: [],
                        issues: [],
                        positives: [],
                        topics: []
                    };
                }
                return performCustomAnalysis(text);
            }

            function sendFeedbackEmail(data) {
                const satisfactionLabels = {
                    1: 'Very Poor 😞', 2: 'Poor 😕', 3: 'Fair 😐', 4: 'Good 😊', 5: 'Excellent 🤩'
                };
                const recommendLabels = {
                    1: 'Never 👎', 2: 'Unlikely 🤷', 3: 'Maybe 🤔', 4: 'Likely 👍', 5: 'Definitely 💯'
                };
                const templateParams = {
                    hospital_name: data.hospital,
                    patient_name: data.patientName,
                    patient_contact: data.patientContact,
                    satisfaction_rating: satisfactionLabels[data.satisfaction] || 'Not provided',
                    recommendation_rating: recommendLabels[data.recommendation] || 'Not provided',
                    comments: data.comments || 'No comments provided',
                    sentiment_score: data.sentimentAnalysis ? data.sentimentAnalysis.score.toFixed(1) : 'N/A',
                    sentiment_label: data.sentimentAnalysis ? data.sentimentAnalysis.sentiment : 'N/A',
                    sentiment_confidence: data.sentimentAnalysis ? (data.sentimentAnalysis.confidence * 100).toFixed(0) + '%' : 'N/A',
                    keywords: data.sentimentAnalysis ? data.sentimentAnalysis.keywords.join(', ') : 'None',
                    issues: data.sentimentAnalysis ? data.sentimentAnalysis.issues.join(', ') || 'None' : 'None',
                    positives: data.sentimentAnalysis ? data.sentimentAnalysis.positives.join(', ') || 'None' : 'None',
                    feedback_timestamp: new Date(data.timestamp).toLocaleString()
                };
                emailjs.send('service_vmknsar', 'template_2f4o2a9', templateParams)
                    .then(() => console.log('Feedback email sent'))
                    .catch(error => console.error('Feedback email failed:', error));
            }
        });
    </script>
</body>
</html>
